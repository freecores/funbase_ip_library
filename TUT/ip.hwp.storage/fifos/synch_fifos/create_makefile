#
# Skripti kaantaa kaikki vhdl-tiedostot ja tekee niista makefilen
# Ymparistomuuttjat 
#	CODEC_DATA_DIR 	kertoo mihin hakemistoon kaannetyt fiilut laitetaan.
#	CODEC_WORK_DIR  kertoo tyohakemiston (mm. Makefile.vhdl on siella)
#	

clear
#Poistetaan vanha codelib ja tehdaan ja mapataan uusi
echo "Removing old vhdl library"
rm -rf $CODEC_DATA_DIR/codelib
echo; echo "Creating a new library at"
echo $CODEC_DATA_DIR; echo

vlib $CODEC_DATA_DIR/codelib
vmap work $CODEC_DATA_DIR/codelib

# Hibi-koodit v2
echo; echo "Compiling vhdl codes"; echo

vcom Vhdl/shift_slot.vhdl

vcom Vhdl/fifo_iom.vhdl
vcom Vhdl/fifo_im.vhdl
vcom Vhdl/fifo_shift.vhdl
vcom Vhdl/fifo_shift_slotted.vhdl
#vcom Vhdl/fifo_casev3.vhdl
#vcom Vhdl/fifo_im_case.vhdl
vcom Vhdl/fifo_casev5.vhdl
vcom Vhdl/fifo_casev4.vhdl
vcom Vhdl/fifo_mixed_clocks.vhdl

# Testipenkit
echo; echo "Compiling vhdl testbenches";echo

vcom Testbench/tb_fifo1.vhdl
vcom Testbench/tb_fifo2.vhdl
vcom Testbench/tb_fifo_mixed_clocks2.vhdl




# Poistetaan vanha makefile ja tehdaan uusi
echo;echo "Creating a new makefile"
rm -f $CODEC_WORK_DIR/Makefile.vhdl
vmake $CODEC_DATA_DIR/codelib > $CODEC_WORK_DIR/Makefile

echo " --------Create_Makefile done-------------"



